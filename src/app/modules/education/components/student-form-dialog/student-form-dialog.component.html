<app-dialog contentClass="sm:max-w-lg max-w-3xl max-h-[90vh] overflow-y-auto">
  <app-dialog-header>
    <app-dialog-title>{{ isEditMode ? 'Editar Estudante' : 'Novo Estudante' }}</app-dialog-title>
    <app-dialog-description>
      {{
        isEditMode ? 'Atualize as informações do estudante' : 'Preencha os dados do novo estudante'
      }}
    </app-dialog-description>
  </app-dialog-header>

  <form [formGroup]="studentForm" (ngSubmit)="onSubmit()" class="space-y-6 mt-4">
    <!-- Basic Information -->
    <div class="space-y-4">
      <h4 class="font-semibold text-gray-900">Informações Básicas</h4>

      <div class="grid grid-cols-2 gap-4">
        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="name-input"
            >Nome Completo</label
          >
          <input class="app-input" id="name-input" formControlName="name" required />
          <!-- @if (studentForm.get('name')?.hasError('required')) {
            <span>Nome é obrigatório</span>
          } -->
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="age-input">Idade</label>
          <input class="app-input" type="number" id="age-input" formControlName="age" required />
          <!-- @if (studentForm.get('age')?.hasError('required')) {
            <span>Idade é obrigatória</span>
          } -->
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="cpf-input">CPF</label>
          <input class="app-input" id="cpf-input" formControlName="cpf" />
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="race">Raça/Etnia</label>
          <ng-select
            class="app-select"
            #agreeSelect
            labelForId="race"
            [searchable]="false"
            [clearable]="false"
            formControlName="race"
          >
            <ng-option value="">Selecione</ng-option>
            <ng-option value="branca">Branca</ng-option>
            <ng-option value="preta">Preta</ng-option>
            <ng-option value="parda">Parda</ng-option>
            <ng-option value="amarela">Amarela</ng-option>
            <ng-option value="indigena">Indígena</ng-option>
          </ng-select>
        </div>

        <div class="w-full col-span-2 mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="place-birth-input"
            >Local de Nascimento</label
          >
          <input
            class="app-input"
            id="place-birth-input"
            formControlName="placeOfBirth"
            placeholder="Cidade, Estado"
          />
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="fatherName-input"
            >Nome do Pai</label
          >
          <input class="app-input" id="fatherName-input" formControlName="fatherName" />
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="motherName-input"
            >Nome da Mãe</label
          >
          <input class="app-input" id="motherName-input" formControlName="motherName" />
        </div>
      </div>
    </div>

    <!-- Academic Information -->
    <div class="space-y-4">
      <h4 class="font-semibold text-gray-900">Informações Acadêmicas</h4>

      <div class="grid grid-cols-2 gap-4">
        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="grade-input"
            >Série/Ano</label
          >
          <input class="app-input" id="grade-input" formControlName="grade" required />
          <!-- @if (studentForm.get('grade')?.hasError('required')) {
            <span>Série/Ano é obrigatório</span>
          } -->
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="enrollmentDate-input"
            >Data de Matrícula</label
          >
          <input
            class="app-input"
            id="enrollmentDate-input"
            type="date"
            formControlName="enrollmentDate"
            required
          />
          <!-- @if (studentForm.get('enrollmentDate')?.hasError('required')) {
            <span>Data de matrícula é obrigatória</span>
          } -->
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="enrollmentOrigin-select"
            >Origem da Matrícula</label
          >
          <ng-select
            class="app-select"
            formControlName="enrollmentOrigin"
            labelForId="enrollmentOrigin-select"
          >
            <ng-option value="">Selecione</ng-option>
            <ng-option value="community">Comunidade</ng-option>
            <ng-option value="school">Escola</ng-option>
            <ng-option value="social_services">Serviços Sociais</ng-option>
          </ng-select>
        </div>

        <div class="w-full mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="status-select"
            >Status</label
          >
          <ng-select
            class="app-select"
            formControlName="status"
            required
            labelForId="status-select"
          >
            <ng-option value="active">Ativo</ng-option>
            <ng-option value="inactive">Inativo</ng-option>
            <ng-option value="graduated">Graduado</ng-option>
          </ng-select>
        </div>

        <div class="w-full col-span-2 mb-2">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="accompaniedStatus-select"
            >Status de Acompanhamento</label
          >
          <ng-select
            class="app-select"
            formControlName="accompaniedStatus"
            labelForId="accompaniedStatus-select"
          >
            <ng-option value="">Selecione</ng-option>
            <ng-option value="accompanied">Acompanhado</ng-option>
            <ng-option value="not_accompanied">Não Acompanhado</ng-option>
          </ng-select>
        </div>
      </div>
    </div>

    <!-- Guardian Information -->
    <div class="space-y-4">
      <h4 class="font-semibold text-gray-900">Informações do Responsável</h4>

      <div class="grid grid-cols-2 gap-4">
        <div class="w-full">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="guardian-input"
            >Nome do Responsável</label
          >
          <input class="app-input" id="guardian-input" formControlName="guardian" required />
          <!-- @if (studentForm.get('guardian')?.hasError('required')) {
            <span>Nome do responsável é obrigatório</span>
          } -->
        </div>

        <div class="w-full">
          <label class="app-label text-sm text-gray-900 mb-2 block" for="guardianPhone-input"
            >Telefone do Responsável</label
          >
          <input
            class="app-input"
            id="guardianPhone-input"
            formControlName="guardianPhone"
            type="tel"
            required
          />
          <!-- @if (studentForm.get('guardianPhone')?.hasError('required')) {
            <span>Telefone é obrigatório</span>
          } -->
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex justify-end gap-3 pt-4 border-t">
      <app-button
        type="button"
        variant="outline"
        (click)="cancel()"
        class="w-full"
        contentClass="w-full"
      >
        Cancelar
      </app-button>
      <app-button
        type="submit"
        [disabled]="!studentForm.valid"
        contentClass="bg-green-600 hover:bg-green-700 w-full"
        class="w-full"
      >
        {{ isEditMode ? 'Atualizar' : 'Criar' }}
      </app-button>
    </div>
  </form>
</app-dialog>
